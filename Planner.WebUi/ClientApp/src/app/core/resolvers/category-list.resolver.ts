import { Injectable } from "@angular/core";
import { ActivatedRouteSnapshot, Resolve } from "@angular/router";
import { Observable } from "rxjs";
import { map } from 'rxjs/operators';
import { GetPageOfLostAndFoundCategoriesQuery, PageOfOfLostAndFoundCategoryGridItemViewModel, LostAndFoundCategoryGridItemViewModel, LostAndFoundCategoryManagementClient } from "../autogenerated-clients/api-client";

@Injectable({ providedIn: "root" })
export class CategoryListResolver implements Resolve<Observable<Array<LostAndFoundCategoryGridItemViewModel>>> {
  constructor(private categoryClient: LostAndFoundCategoryManagementClient) { }

  resolve(routeSnapshot: ActivatedRouteSnapshot) {
    return this.categoryClient
      .getPageOfLostAndFoundCategories(new GetPageOfLostAndFoundCategoriesQuery({ skip: 0, take: 0, keywords: null, sortKey: null }))
      .pipe(
        map((response: PageOfOfLostAndFoundCategoryGridItemViewModel) => {
          return response.items;
        })
      );
  }
}
