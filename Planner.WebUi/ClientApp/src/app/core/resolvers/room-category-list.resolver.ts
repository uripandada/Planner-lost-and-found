import { Injectable } from "@angular/core";
import { ActivatedRouteSnapshot, Resolve } from "@angular/router";
import { Observable } from "rxjs";
import { map } from 'rxjs/operators';
import { GetPageOfRoomCategoriesQuery, PageOfOfRoomCategoryGridItemViewModel, RoomCategoryGridItemViewModel, RoomCategoryManagementClient } from "../autogenerated-clients/api-client";

@Injectable({ providedIn: "root" })
export class RoomCategoryListResolver implements Resolve<Observable<Array<RoomCategoryGridItemViewModel>>> {
  constructor(private categoryClient: RoomCategoryManagementClient) { }

  resolve(routeSnapshot: ActivatedRouteSnapshot) {
    return this.categoryClient
      .getPageOfRoomCategories(new GetPageOfRoomCategoriesQuery({ skip: 0, take: 0, keywords: null, sortKey: null }))
      .pipe(
        map((response: PageOfOfRoomCategoryGridItemViewModel) => {
          return response.items;
        })
      );
  }
}
