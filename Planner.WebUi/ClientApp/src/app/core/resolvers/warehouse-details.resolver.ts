import { Injectable } from '@angular/core';
import { ActivatedRouteSnapshot, Resolve } from '@angular/router';
import { Observable, of } from 'rxjs';
import { GetWarehouseDetailsQuery, WarehouseDetailsData, WarehouseManagementClient } from '../autogenerated-clients/api-client';

@Injectable({ providedIn: 'root' })
export class WarehouseDetailsResolver implements Resolve<Observable<WarehouseDetailsData>> {
  constructor(private warehouseClient: WarehouseManagementClient) { }

  resolve(routeSnapshot: ActivatedRouteSnapshot) {
    const warehouseId: string = routeSnapshot.params.warehouseId;

    if (warehouseId) {
      let request: GetWarehouseDetailsQuery = new GetWarehouseDetailsQuery({
        id: warehouseId,
        floorId: null,
        hotelId: null,
      });

      return this.warehouseClient.getWarehouseDetails(request);
    }
    else {
      let request: GetWarehouseDetailsQuery = new GetWarehouseDetailsQuery({
        id: null,
        floorId: routeSnapshot.params.floorId,
        hotelId: routeSnapshot.params.hotelId,
      });

      return this.warehouseClient.getWarehouseDetails(request);
    }
  }
}
